<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link href="views/styles/formStyle.css" rel="stylesheet" type="text/css"/>
        <link href="views/styles/resultTable.css" rel="stylesheet" type="text/css"/>
        <link href='http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>


        <title>Search For Flights</title>        
    </head>
    <body>
        <div class="form-style-inline">
            <h2>Search For Flights</h2>
            <form>
                <label>Departure date&nbsp;</label>
                <input type="date" ng-model="searchParams.date" onkeydown="return false;" min="2017-01-01"/>

                <label>Departure Airport</label>
                <select ng-model="searchParams.from">
                    <option ng-repeat="x in airports" value="{{x.code}}">{{x.name}}</option>
                </select>

                <label>No. Of passengers</label>
                <input type="number" min="1" max="10" ng-model="searchParams.tickets">
                <input type="button" value="Search" ng-click="getSearchResults()"/>
            </form>

            <form>     
                <label>Flexible Date</label>
                <input type="checkbox" ng-model="flextoggle" onClick="document.getElementById('flexDate').disabled = !this.checked;">
                <input id="flexDate" type="date" ng-model="searchParams.flexdate" onkeydown="return false;" min="{{searchParams.date| date:'yyyy-MM-dd'}}" disabled="disabled"/>

                <label>Destination Airport</label>
                <input type="checkbox" ng-model="fixedDestination" onClick="document.getElementById('destination').disabled = !this.checked;">
                <select id="destination" ng-model="searchParams.to" disabled="disabled">
                    <option ng-repeat="x in airports" value="{{x.code}}">{{x.name}}</option>
                </select>
            </form>
        </div>

        <div class="form-style-inline" ng-show="errorOccured === true">
            <div style="text-align: center; color: white; font-size: 20px">
                Some fields in the search form is not filled out, <br>
                or is filled out incorrectly
            </div>
        </div>        

        <div class="form-style-inline" ng-show="noFlights === true">
            <div style="text-align: center; color: white; font-size: 20px">
                No flights available. Please choose another date or destination.
            </div>
        </div>

        <div>
            <table border="1" ng-show="isSearched">
                <thead>
                <th><span> Airline </span></th>
                <th><span> Flight Number </span></th>
                <th><span> Departure airport </span></th>
                <th><span> Departure date </span></th>
                <th><span> Arrival airport </span></th>
                <th><span> Travel Time </span></th>
                <th><span> Seats </span></th>
                <th><span> Total Price </span></th>
                <th><span> Reserve Tickets</span></th>
                </thead>
                <tbody ng-repeat="date in searchResults| orderBy: 'flights[0].date'">
                    <tr>
                        <td class="dateheader" colspan="9" style="text-align: center" >
                            Flights for {{date.flights[0].date| date : 'longDate'}}
                        </td>
                    </tr>
                    <tr ng-repeat="flight in date.flights| orderBy: 'date'" >
                        <td> {{date.airline}}</td>
                        <td> {{flight.flightNumber}}</td>
                        <td> {{iATAToName(flight.origin)}}</td>
                        <td> {{flight.date| date : "short"}}</td>
                        <td> {{iATAToName(flight.destination)}}</td>
                        <td> {{minutesToHours(flight.traveltime)}}</td>
                        <td> {{flight.numberOfSeats}}</td>
                        <td> {{flight.totalPrice| currency : "Kr. "}}</td>
                        <td  ng-click="reservationSetData(flight)"><a href="#/reservation" >Reserve tickets</a></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>

